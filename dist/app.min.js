angular.module("app", [ "ui.router" ]);

(function() {
    angular.module("app").controller("case1Controller", Case1Controller);
    function Case1Controller($scope, $sce, employeeService) {
        var allEmployees;
        $scope.case1 = function() {
            var employees = allEmployees;
            $scope.employees = employees;
            $scope.prettyJson = $sce.trustAsHtml(helpers.prettyJson(employees));
            $scope.case = 1;
            console.log($scope.case);
        };
        function init() {
            console.log("case 1");
        }
        init();
    }
})();

(function() {
    angular.module("app").factory("employeeService", EmployeeService);
    EmployeeService.$inject = [ "$http" ];
    function EmployeeService($http) {
        "use strict";
        return {
            get: getEmployees
        };
        function getEmployees() {
            return $http.get("./data/employees.json").then(function(response) {
                return response.data;
            });
        }
    }
})();

(function() {
    angular.module("app").factory("helpers", HelperService);
    function HelperService() {
        return {
            prettyJson: prettyJson
        };
    }
    function prettyJson(json) {
        var jsonRegex = /("(\\u[a-zA-Z0-9]{4}|\\[^u]|[^\\"])*"(\s*:)?|\b(true|false|null)\b|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?)/g;
        if (typeof json !== "string") {
            json = JSON.stringify(json, undefined, 2);
        }
        json = json.replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;");
        return json.replace(jsonRegex, function(match) {
            var cls = "number";
            if (/^"/.test(match)) {
                if (/:$/.test(match)) {
                    cls = "key";
                } else {
                    cls = "string";
                }
            } else if (/true|false/.test(match)) {
                cls = "boolean";
            } else if (/null/.test(match)) {
                cls = "null";
            }
            return '<span class="' + cls + '">' + match + "</span>";
        });
    }
})();

(function() {
    angular.module("app").config(routes);
    routes.$inject = [ "$stateProvider", "$urlRouterProvider" ];
    function routes($stateProvider, $urlRouterProvider) {
        $urlRouterProvider.otherwise("/");
        $stateProvider.state("main", {
            url: "/",
            templateUrl: "main/main.html",
            controller: "mainController as mainCtrl"
        }).state("case1", {
            url: "/case1",
            templateUrl: "case1/case1.html",
            controller: "case1Controller as case1Ctrl"
        });
    }
})();

(function() {
    angular.module("app").controller("mainController", MainController);
    MainController.$inject = [ "$scope", "$sce", "employeeService", "helpers" ];
    function MainController($scope, $sce, employeeService, helpers) {
        function init() {
            var allEmployees;
            employeeService.get().then(function(data) {
                allEmployees = data;
                $scope.prettyJson = $sce.trustAsHtml(helpers.prettyJson(allEmployees));
            });
        }
        init();
    }
})();
